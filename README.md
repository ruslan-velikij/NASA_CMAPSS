# NASA_CMAPSS
Machine learning model training by NASA CMPASS dataset

# Libs download
In project directory:
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt

Особенности задачи:
- Беру первый датасет "FD001, Траектории движения поездов: 100, Тестовых траекторий: 100, Условий: ОДИН (уровень моря), Режимы неисправностей: ОДИН (деградация HPC)"
- Набор данных состоит из многомерного временного ряда
- Есть обучающий набор данных и тестовый
- Каждый двигатель запускается с разной степени первоначального износа. Пользователю недоступно знание, на каком этапе находился износ двигателя до его запуска и считывания данных счетчиками. Соответственно, не понятно сколько еще осталось
- Есть три режима, что влияют с разной степенью на износ двигателя. Режим включен во временной ряд
- Данные искажены шумом датчика
- В начале работы двигателя он функционирует нормально, но в какой-то момент выходит из строя
- В обучающем наборе данных где-то возникает неисправность, она увеличивается и она влияет на работу до момента, когда двигатель всё
- Временной ряд заканчивается за некоторое время до сбоя системы, то есть нам не известно исходя их данных, когда точно будет сбой. Наверное это и следует оценить моделью
- Цель соревнования - предсказать выход из строя двигателя, сколько еще циклом осталось до сбоя
- Для тестовых данных представлен истинный временной ряд до сбоя

- В наборе данных столбцы разделены пробелом
- 26 стобцов
- Каждая строка - моментальный снимок системы в одну единицу работы цикла
- Каждый столбец - отдельная переменная (номер единицы измерения, время в циклах, рабочая настройка 1-3, дитчики 1-21)

Шаги:
0. Шаг - Разобраться с целью задачи: цель - спрогнозировать показатель RUL на основании тестовых данных и визуализировать разницу
1. Шаг - Подготовка данных: загрузить данные через Pandas и получить табличную структуру DataFrame, зададим имена полям; предварительно оценить, правильно ли разметились данные и создана структура таблицы; определить расчет переменной RUL, сколько осталось до выхода из строя, где выход из строя RUL = 0, 1 цикл до выхода из строя RUL = 1
2. Шаг - Разделение на обучающую и валидационную выборку 80/20%: выбираем 20 двигателей для валидации и остальные 80 для обучения, выбор случайный, но фиксированный (seed 42)
3. Шаг - Выбор признаков: убираем из обучения некоторые поля, значения в которых не меняются или четко последовательны, например, id cycle setting3 sensor1 и тд; формируем матрицу признаков и целевой переменной
4. Шаг - Обучение регрессионной модели: Пытаемся предсказать RUL с помощью регрессии, выбираю алгоритм Random Forest Regressor
5. Шаг - Оценка качества модели на валидации: Сравниваю предсказанные данные с реальными значения RUL, использую метрики MSE RMSE MAE
6. Шаг - Применение модели к тестовым данным и формирование предсказаний: Переход на тестовые данные с неизвестным циклом сбоя, могу прогнозировать; беру последнюю запись у двигателя и добавляю спрогнозированные циклы RUL; сравнить прогноз с реальностью
7. Шаг - Сравнение предсказаний с реальными RUL: для количественной оценки снова вычислю RMSE и MAE уже на тестовом наборе
8. Шаг - Визуализация результатов предсказания vs реальный RUL
9. Шаг - Визуализация результатов предсказания vs реальный RUL, где ошибка по модулю меньше 35